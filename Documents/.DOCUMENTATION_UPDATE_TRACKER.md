# Documentation Update Tracker - Code Changes Impact

**Created**: 2025-10-15
**Reason**: Code update received on 2025-06-24 affects line number references across all documentation
**Affected Files**: 12 source files modified
**Impacted Documents**: ~194 markdown files (estimated 60-80 require updates)

---

## Executive Summary

### Problem
Code changes on June 24, 2025 modified multiple source files, causing **line number shifts** in:
- `AirbagSPs.cs` - **92 new lines added** across multiple locations
- `PackingDataService.cs` - 3 lines added
- Multiple XAML.cs files - various changes

All existing documentation that references specific line numbers is now **OUT OF DATE**.

### Impact Scale
- **194 total markdown documents** exist in Documents folder
- **~103 database procedure docs** with line references in AirbagSPs.cs
- **~40 LAB system docs** with code line references
- **~30 Process workflow docs** with code references
- **~20 UI Logic Analysis docs** with XAML.cs references

### Recommendation: PHASED UPDATE STRATEGY

**Option A: AUTOMATED BATCH UPDATE** (Recommended)
- Use git diff to calculate line shifts
- Write script to auto-update all line references
- Review and verify critical docs manually
- **Time**: 2-4 hours
- **Risk**: LOW (reversible, can verify)

**Option B: MANUAL SELECTIVE UPDATE** (Alternative)
- Update only frequently accessed documents
- Mark others with "⚠️ LINE NUMBERS OUTDATED" banner
- Update on-demand when accessed
- **Time**: 1-2 days spread over time
- **Risk**: MEDIUM (inconsistent documentation)

**Option C: FULL MANUAL UPDATE** (Not Recommended)
- Manually verify every line reference in all 194 files
- **Time**: 3-5 days
- **Risk**: HIGH (human error, tedious)

---

## RECOMMENDED APPROACH: Automated Batch Update

### Phase 1: Calculate Line Shifts (30 minutes)

**Task 1.1**: Extract line shift map from git diff
```bash
# Generate line shift analysis
git diff HEAD LuckyTex.AirBag.Core/Domains/AirbagSPs.cs > airbag_sps_diff.txt

# Parse shifts:
# @@ -2202,0 +2203,2 @@ means: after line 2202, 2 lines inserted → all lines after 2202 shift +2
# @@ -2932,0 +2935,14 @@ means: after line 2932, 14 lines inserted → shift +14
```

**Task 1.2**: Create shift calculation table
```
Line Range     | Shift Amount | Reason
---------------|--------------|---------------------------
0-2202         | 0            | No change
2203-2931      | +2           | GROSSLENGTH field added
2932-3091      | +16          | +2 from above, +14 new (MAXFORCE fields)
3092-3181      | +29          | +16 from above, +13 new
3182-3269      | +56          | +29 from above, +27 new (LAB_SAVEREPLCFLEXABRASION)
3270+          | +91          | +56 from above, +35 new (LAB_SAVEFLEXABRASIONPLCDATA)
```

**Task 1.3**: Identify all affected line ranges in existing docs

---

### Phase 2: Update Database Procedure Docs (1 hour)

**Affected Files**: 103 files in `Documents/Database/`

#### Impact Analysis by Module:

**M02 - Warping** (26 procedures)
- Files: `002-WARP_CANCELCREELSETUP.md` through `026-WARP_WARPLIST.md`
- AirbagSPs.cs references: Lines ~1000-2500
- **Impact**: MINIMAL (most before line 2202, no shift needed)
- **Action**: ✅ Verify only - likely no changes needed

**M03 - Beaming** (20 procedures)
- Files: `027-BEAM_BEAMLIST.md` through `046-BEAM_UPDATEBEAMNO.md`
- AirbagSPs.cs references: Lines ~2000-3500
- **Impact**: MEDIUM (some in shift zones)
- **Action**: 🔄 Update lines in range 2203-3500

**M04 - Drawing** (7 procedures)
- Files: `047-DRAW_DAILYREPORT.md` through `053-DRAW_UPDATEDRAWING.md`
- AirbagSPs.cs references: Lines ~3000-4000
- **Impact**: HIGH (many in shift zones)
- **Action**: 🔄 Update lines in range 2203+

**M05 - Weaving** (33 procedures)
- Files: `054-WEAV_DEFECTLIST.md` through `086-WEAVE_WEAVINGPROCESS.md`
- AirbagSPs.cs references: Lines ~4000-7000
- **Impact**: HIGH (all affected by cumulative +91 shift)
- **Action**: 🔄 Update ALL line references +91

**M06 - Finishing** (17 procedures completed)
- Files: `087-FINISHING_CHECKITEMWEAVING.md` through `103-FINISHING_UPDATESCOURINGDATA.md`
- AirbagSPs.cs references: Lines ~6800-7200
- **Impact**: HIGH (all affected by +91 shift)
- **Action**: 🔄 Update ALL line references +91

**M08 - Inspection** (2 procedures)
- Files: `232-INSERTUPDATEFINISHINGDATA.md`, `233-INSERTUPDATEWEAVINGDATA.md`
- AirbagSPs.cs references: Lines ~8000+
- **Impact**: HIGH (+91 shift)
- **Action**: 🔄 Update ALL line references +91

#### Update Script Template:

```python
# Pseudo-code for automated update
for doc in database_procedure_docs:
    content = read_file(doc)

    # Find all line references like "Lines**: 7047-7113"
    matches = regex.findall(r'Lines\*\*: (\d+)-(\d+)', content)

    for start, end in matches:
        # Apply appropriate shift based on line range
        if int(start) > 3270:
            new_start = int(start) + 91
            new_end = int(end) + 91
        elif int(start) > 3182:
            new_start = int(start) + 56
            new_end = int(end) + 56
        # ... etc for other ranges

        content = content.replace(
            f"Lines**: {start}-{end}",
            f"Lines**: {new_start}-{new_end}"
        )

    write_file(doc, content)
```

---

### Phase 3: Update LAB System Docs (45 minutes)

**Affected Files**: ~40 files in `Documents/LAB/`

#### Modules Affected:

**01_Lab_Test** - ⚠️ HIGH PRIORITY
- File: `001-PROCESS_LAB_TEST_OPERATIONS.md`
- Contains: Workflow diagrams, code snippets
- **New procedures added**: LAB_SAVEREPLCFLEXABRASION, LAB_SAVEFLEXABRASIONPLCDATA
- **Action**:
  - ✅ Add new procedures to procedure list
  - 🔄 Update AirbagSPs.cs line references
  - 📝 Add new workflow diagrams for flex abrasion testing

**03_Lab_Data_Entry** - ⚠️ CRITICAL
- File: `003-PROCESS_MANUAL_TEST_ENTRY.md`
- Contains: **196,424 LOC analysis**
- **New fields**: MAXFORCE_W4-W6, F4-F6, ELONGATIONFORCE_W4-W6, F4-F6
- **Action**:
  - 📝 Document new 6-point testing (was 3-point)
  - 🔄 Update UI field references
  - 📝 Update validation logic for 6 test points
  - 🔄 Update stored procedure parameter lists

**07_PLC_Get_Data** - ⚠️ HIGH PRIORITY
- File: `007-PROCESS_LAB_EQUIPMENT_INTEGRATION.md`
- **New integration**: Flex abrasion PLC data collection
- **Action**:
  - 📝 Add flex abrasion equipment section
  - 📝 Document LAB_SAVEFLEXABRASIONPLCDATA integration
  - 📝 Add PLC communication protocol details

#### Update Checklist:

- [ ] Add LAB_SAVEREPLCFLEXABRASION to procedure inventory
- [ ] Add LAB_SAVEFLEXABRASIONPLCDATA to procedure inventory
- [ ] Update Database/.DATABASE_STORED_PROCEDURES_TODO.md (add 2 procedures to LAB section)
- [ ] Update all AirbagSPs.cs line references in LAB docs (+91 shift for lines after 3270)
- [ ] Document new MAXFORCE/ELONGATIONFORCE fields (W4-W6, F4-F6)
- [ ] Update tensile test workflow (3-point → 6-point)
- [ ] Add flex abrasion test workflow documentation

---

### Phase 4: Update Process Workflow Docs (30 minutes)

**Affected Files**: ~30 files in `Documents/Processes/`

#### High Priority Updates:

**13_Packing** - ⚠️ CRITICAL (New Feature)
- Files affected:
  - Any packing workflow docs
  - `041-UI_LOGIC_PACKING_LABEL.md` (confirmed reference)
- **New field**: GROSSLENGTH
- **New feature**: CM08 customer label format
- **Action**:
  - 📝 Add GROSSLENGTH field to packing data models
  - 📝 Document waste calculation: GROSSLENGTH - NET_LENGTH
  - 📝 Add CM08 label printing workflow
  - 📝 Document conditional label logic (CM08 vs standard)
  - 🔄 Update PackingDataService.cs line 657 reference
  - 📝 Add RepPackingLabelCM08.rdlc report documentation

**05_Weaving** - ⚠️ MEDIUM
- File: `WeavingProductionPage.xaml.cs` modified
- **Action**:
  - 🔄 Review changes and update if significant logic changes
  - 📝 Document any new features/bug fixes

**08_Inspection** - ⚠️ MEDIUM
- Files: `InspectionModulePage.xaml.cs`, `SearchInspectionDataPage.xaml.cs` modified
- **Action**:
  - 🔄 Review changes and update if significant logic changes
  - 📝 Document any new features/bug fixes

#### Update Checklist:

- [ ] Review all 13_Packing process docs for GROSSLENGTH references
- [ ] Add CM08 label workflow documentation
- [ ] Update packing data model diagrams (add GROSSLENGTH field)
- [ ] Review and update Weaving process docs if logic changed
- [ ] Review and update Inspection process docs if logic changed

---

### Phase 5: Update UI Logic Analysis Docs (30 minutes)

**Affected Files**: ~20 files in `Documents/Processes/UI_Logic_Analysis/`

#### Confirmed Affected:

**13_Packing/041-UI_LOGIC_PACKING_LABEL.md**
- **Impact**: HIGH (PackingLabelPage.xaml.cs modified significantly)
- **Changes**:
  - New method: PreviewCM08()
  - New conditional: `if (cmID == "08")`
- **Action**:
  - 📝 Update Input Validation flowchart (add CM08 branch)
  - 📝 Update UI State Transition diagram (add CM08 state)
  - 📝 Update Control Enable/Disable logic
  - 🔄 Update all line number references

**05_Weaving/** - TBD
- WeavingProductionPage.xaml.cs modified
- **Action**:
  - 🔄 Review diff to determine if UI logic analysis needs update
  - 📝 Update if significant validation/control logic changed

**08_Inspection/** - TBD
- InspectionModulePage.xaml.cs modified
- SearchInspectionDataPage.xaml.cs modified
- **Action**:
  - 🔄 Review diff to determine if UI logic analysis needs update
  - 📝 Update if significant validation/control logic changed

---

### Phase 6: Update Reference Documents (15 minutes)

**Files to Update**:

1. **Documents/MODERNIZATION_ANALYSIS.md**
   - Contains code inventory with line counts
   - **Action**: Update LOC counts if significantly changed

2. **Documents/Database/.DATABASE_STORED_PROCEDURES_TODO.md**
   - **Action**: ✅ Add 2 new LAB procedures
   - Update: Total count 296 → 298 procedures

3. **Documents/Database/.DATABASE_ANALYSIS_TRACKER.md**
   - **Action**: Note June 24 code update event

4. **Documents/Database/README.md**
   - **Action**: Add note about June 24 update

5. **Documents/CODE_UPDATE_SUMMARY_2025-06-24.md**
   - Already created ✅

---

## Detailed Task List

### Immediate Actions (Priority 1) - 2 hours

- [ ] **Task 1**: Generate complete line shift mapping from git diff
  - [ ] Parse `AirbagSPs.cs` diff for all insertion points
  - [ ] Create shift table (line ranges → shift amounts)
  - [ ] Validate shift calculations

- [ ] **Task 2**: Update Database Procedure Docs (103 files)
  - [ ] Run automated line reference updater script
  - [ ] Manual verification of critical procedures (Finishing, Weaving)
  - [ ] Spot-check 10 random files for accuracy

- [ ] **Task 3**: Add new LAB procedures to tracking
  - [ ] Add LAB_SAVEREPLCFLEXABRASION to TODO tracker
  - [ ] Add LAB_SAVEFLEXABRASIONPLCDATA to TODO tracker
  - [ ] Update procedure count: 296 → 298

- [ ] **Task 4**: Update Packing documentation (GROSSLENGTH + CM08)
  - [ ] Add GROSSLENGTH to packing process docs
  - [ ] Document CM08 label workflow
  - [ ] Update UI logic analysis for PackingLabelPage

---

### Secondary Actions (Priority 2) - 1 hour

- [ ] **Task 5**: Update LAB system documentation
  - [ ] Document flex abrasion testing workflow
  - [ ] Update tensile test docs (3-point → 6-point)
  - [ ] Update all LAB AirbagSPs.cs line references (+91 shift)

- [ ] **Task 6**: Review and update Weaving/Inspection docs
  - [ ] Analyze Weaving code changes for documentation impact
  - [ ] Analyze Inspection code changes for documentation impact
  - [ ] Update UI logic if needed

- [ ] **Task 7**: Update reference/tracking documents
  - [ ] Update .DATABASE_STORED_PROCEDURES_TODO.md
  - [ ] Update .DATABASE_ANALYSIS_TRACKER.md
  - [ ] Add notes to relevant README files

---

### Optional Actions (Priority 3) - As needed

- [ ] **Task 8**: Create validation report
  - [ ] List all updated documents
  - [ ] List verification status
  - [ ] Note any documents marked for future update

- [ ] **Task 9**: Update modernization analysis
  - [ ] Recalculate LOC counts if needed
  - [ ] Note new features in modernization strategy

---

## Automated Update Script Specification

### Input Files
1. `git diff HEAD LuckyTex.AirBag.Core/Domains/AirbagSPs.cs` - Line shift data
2. `find Documents -name "*.md"` - All markdown files

### Line Shift Calculation Logic

```python
def calculate_shift(line_number):
    """
    Returns the number of lines to add to a line reference
    based on where insertions occurred.
    """
    shifts = [
        (2203, 2),    # After 2202, +2 lines inserted
        (2935, 14),   # After 2932, +14 lines inserted (cumulative: +16)
        (3109, 13),   # After 3092, +13 lines inserted (cumulative: +29)
        (3212, 27),   # After 3182, +27 lines inserted (cumulative: +56)
        (3327, 35),   # After 3270, +35 lines inserted (cumulative: +91)
        # Add more from git diff analysis
    ]

    total_shift = 0
    for insertion_line, lines_added in shifts:
        if line_number >= insertion_line:
            total_shift += lines_added

    return total_shift

def update_document(file_path):
    """Update all line references in a markdown file."""
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()

    # Pattern 1: "Lines**: 7047-7113"
    pattern1 = r'Lines\*\*: (\d+)-(\d+)'
    def replace1(match):
        start = int(match.group(1))
        end = int(match.group(2))
        new_start = start + calculate_shift(start)
        new_end = end + calculate_shift(end)
        return f'Lines**: {new_start}-{new_end}'

    content = re.sub(pattern1, replace1, content)

    # Pattern 2: "Line 2203" or "Lines 100-200"
    pattern2 = r'Line[s]? (\d+)(?:-(\d+))?'
    def replace2(match):
        start = int(match.group(1))
        new_start = start + calculate_shift(start)
        if match.group(2):  # Range
            end = int(match.group(2))
            new_end = end + calculate_shift(end)
            return f'Lines {new_start}-{new_end}'
        else:  # Single line
            return f'Line {new_start}'

    content = re.sub(pattern2, replace2, content)

    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
```

### Execution Plan

```bash
# 1. Generate shift data
git diff HEAD LuckyTex.AirBag.Core/Domains/AirbagSPs.cs > /tmp/shifts.txt

# 2. Run update script on database docs
python update_line_refs.py Documents/Database/*.md

# 3. Run on LAB docs
python update_line_refs.py Documents/LAB/**/*.md

# 4. Run on Process docs
python update_line_refs.py Documents/Processes/**/*.md

# 5. Generate verification report
python verify_updates.py > update_report.txt
```

---

## Verification Checklist

After running automated updates:

### Sample Verification (10 files)
- [ ] Verify M02-Warping procedure 010 (early in file, minimal shift)
- [ ] Verify M03-Beaming procedure 035 (mid-range, moderate shift)
- [ ] Verify M05-Weaving procedure 065 (late in file, maximum shift)
- [ ] Verify M06-Finishing procedure 095 (recently created, high shift)
- [ ] Verify LAB doc 001-PROCESS_LAB_TEST_OPERATIONS.md
- [ ] Verify Packing doc 041-UI_LOGIC_PACKING_LABEL.md
- [ ] Verify Database README.md
- [ ] Verify .DATABASE_STORED_PROCEDURES_TODO.md
- [ ] Verify CODE_UPDATE_SUMMARY document
- [ ] Random selection: 1 file from each module

### Manual Verification Method
For each file:
1. Open file in editor
2. Find line reference (e.g., "Lines**: 7047-7113")
3. Open AirbagSPs.cs and go to that line
4. Verify it's the correct class/procedure
5. If wrong → recalculate shift manually

---

## Rollback Plan

If automated update fails or produces errors:

1. **Git Restore**: All document updates are in Git
   ```bash
   git checkout -- Documents/
   ```

2. **Backup Strategy**: Before running script
   ```bash
   tar -czf docs_backup_$(date +%Y%m%d).tar.gz Documents/
   ```

3. **Manual Fix**: For individual files
   - Keep original line references in comments
   - Example: `Lines**: 7138-7204 <!-- OLD: 7047-7113 -->`

---

## Status Tracking

### Current Status: ⏳ PLANNING PHASE

**Completed**:
- ✅ Impact analysis
- ✅ Code update summary created
- ✅ Documentation update strategy defined

**In Progress**:
- 🔄 Line shift calculation
- 🔄 Script development

**Pending**:
- ⏳ Automated batch update execution
- ⏳ Manual verification
- ⏳ New content creation (LAB flex abrasion, GROSSLENGTH workflows)

---

## Estimated Time Investment

| Phase | Automated | Manual | Total |
|-------|-----------|--------|-------|
| 1. Line shift calculation | 15 min | 15 min | 30 min |
| 2. Database docs (103 files) | 10 min | 30 min | 40 min |
| 3. LAB docs (40 files) | 5 min | 30 min | 35 min |
| 4. Process docs (30 files) | 5 min | 20 min | 25 min |
| 5. UI Logic docs (20 files) | 3 min | 15 min | 18 min |
| 6. Reference docs | 0 min | 15 min | 15 min |
| 7. New content creation | 0 min | 60 min | 60 min |
| 8. Verification | 5 min | 30 min | 35 min |
| **TOTAL** | **43 min** | **3h 35min** | **4h 18min** |

**Recommendation**: Invest the 4 hours to maintain documentation quality and accuracy.

---

## Next Steps

**USER DECISION REQUIRED**:

**Option 1**: Proceed with automated batch update (Recommended)
- I'll create and run the update script
- Verify critical files manually
- Complete in ~4 hours

**Option 2**: Manual selective update
- Update only high-priority docs now
- Mark others for future update
- Spread work over multiple sessions

**Option 3**: Continue current work, defer updates
- Continue with procedure 104 (Dryer operations)
- Update documentation later (before final delivery)

**What would you like me to do?**

---

**Created**: 2025-10-15
**Last Updated**: 2025-10-15
**Status**: Awaiting User Decision
