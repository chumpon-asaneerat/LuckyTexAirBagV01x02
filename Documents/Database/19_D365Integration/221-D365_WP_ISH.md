# D365_WP_ISH

**Procedure Number**: 221 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Warping Issue Header data for D365 ERP material consumption sync |
| **Operation** | SELECT |
| **Tables** | Warping material issue header table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_WARPHEADNO` | VARCHAR2(50) | âœ… | Warp header number (lot number) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `HEADERID` | NUMBER | Issue header ID |
| `TOTALRECORD` | NUMBER | Total number of issue line records |
| `MACHINESTART` | DATE | Machine start timestamp |

---

## Business Logic (What it does and why)

Retrieves Warping material Issue Header data for D365 ERP synchronization. Issue Header represents the summary of all yarn materials consumed during warping production. This is the header record that groups multiple issue line items (ISL).

The procedure:
1. Takes warp header number
2. Returns issue header ID for this production lot
3. Provides total count of material line items
4. Includes machine start time for transaction timestamp
5. Header must be synced before issue lines (ISL)

Part of material consumption tracking in D365 - shows yarn used to create warp beams.

---

## Related Procedures

**Downstream**:
- [222-D365_WP_ISL.md](./222-D365_WP_ISL.md) - Issue lines (detail records)

**Related**:
- [220-D365_WP_BPO.md](./220-D365_WP_BPO.md) - Batch production order

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\Services\DataService\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\Domains\AirbagSPs.cs`
**Method**: `D365_WP_ISH(D365_WP_ISHParameter para)`
**Lines**: 32663-32704

---

**File**: 221/296 | **Progress**: 74.7%
