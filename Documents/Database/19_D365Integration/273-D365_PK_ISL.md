# D365_PK_ISL

**Procedure Number**: 273 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Packing Issue Line details for D365 ERP material consumption detail sync |
| **Operation** | SELECT |
| **Tables** | Packing material issue detail table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_PALLETNO` | VARCHAR2(50) | âœ… | Pallet number (shipping identifier) |
| `P_ITEMCODE` | VARCHAR2(50) | âœ… | Item code (packed product identifier) |
| `P_LOADINGTYPE` | VARCHAR2(50) | âœ… | Loading type code (customer/order specific) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `LINENO` | NUMBER | Issue line sequence number |
| `ISSUEDATE` | DATE | Material issue date/time |
| `ITEMID` | VARCHAR2(50) | Item ID (cut/printed fabric) in D365 |
| `STYLEID` | VARCHAR2(50) | Style/variant ID |
| `QTY` | NUMBER | Quantity issued (consumed for packing) |
| `UNIT` | VARCHAR2(50) | Unit of measure |
| `SERIALID` | VARCHAR2(50) | Serial/batch ID for traceability |

---

## Business Logic (What it does and why)

Retrieves Packing material Issue Line details for D365 ERP synchronization. Issue Lines are the detail records showing each cut/printed fabric piece consumed for packing operations. Each line represents one fabric piece input with complete traceability through serial ID.

The procedure:
1. Takes pallet number, item code, and loading type to identify the packing operation
2. Returns all issue line items for this packing lot (standard variant)
3. Each line shows which cut/printed fabric was packed (ITEMID, SERIALID)
4. Includes quantity, unit, and issue date/time
5. Used to post material consumption transactions in D365
6. Enables backward traceability (which fabric pieces went onto this pallet)

Synced after Issue Header (ISH) is posted to D365. Used for standard packing process (BPO).

---

## Related Procedures

**Upstream**:
- [272-D365_PK_ISH.md](./272-D365_PK_ISH.md) - Issue header (must sync first)

**Related**:
- [270-D365_PK_BPO.md](./270-D365_PK_BPO.md) - Standard packing BPO
- [274-D365_PK_ISL_C.md](./274-D365_PK_ISL_C.md) - Variant C version

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_PK_ISL(D365_PK_ISLParameter para)`
**Lines**: 35387-35432

---

**File**: 273/296 | **Progress**: 92.2%
