# D365_BM_BPO

**Procedure Number**: 227 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Beaming Batch Production Order data for D365 ERP sync |
| **Operation** | SELECT |
| **Tables** | Beaming production order table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_BEAMERNO` | VARCHAR2(50) | âœ… | Beamer number (production lot identifier) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `PRODID` | NUMBER | Production order ID in D365 |
| `LOTNO` | VARCHAR2(50) | Lot number (batch identifier) |
| `ITEMID` | VARCHAR2(50) | Item ID in D365 ERP system |
| `LOADINGTYPE` | VARCHAR2(50) | Loading type code |
| `QTY` | NUMBER | Quantity produced |
| `UNIT` | VARCHAR2(50) | Unit of measure (e.g., 'BEAM', 'KG') |
| `OPERATION` | VARCHAR2(50) | Operation code (typically 'BEAM') |
| `MACHINESTART` | DATE | Machine start timestamp |

---

## Business Logic (What it does and why)

Retrieves Beaming Batch Production Order data for D365 ERP synchronization. The Batch Production Order (BPO) is the foundational transaction that creates a production order in D365 for beaming operations. Beaming is the process of winding multiple warp beams onto a single weaver's beam with precise tension control.

The procedure:
1. Takes beamer number (production lot ID)
2. Returns production order details for D365 sync
3. Includes item code, quantity, operation type
4. Provides machine start time for production tracking
5. Must be synced FIRST before any material consumption (ISH/ISL) or output (OPH/OPL) transactions

Part of the D365 integration pattern: BPO â†’ ISH/ISL â†’ OPH/OPL â†’ OUH/OUL

---

## Related Procedures

**Downstream**:
- D365_BM_ISH - Material consumption header
- D365_BM_ISL - Material consumption lines
- D365_BM_OPH - Production output header
- D365_BM_OPL - Production output lines

**Similar**:
- [220-D365_WP_BPO.md](./220-D365_WP_BPO.md) - Warping BPO (same pattern)

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_BM_BPO(D365_BM_BPOParameter para)`
**Lines**: 32887-32934

---

**File**: 227/296 | **Progress**: 76.7%
