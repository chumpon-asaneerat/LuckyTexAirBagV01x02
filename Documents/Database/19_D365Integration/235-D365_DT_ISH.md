# D365_DT_ISH

**Procedure Number**: 235 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Drawing Issue Header for D365 ERP material consumption sync |
| **Operation** | SELECT |
| **Tables** | Drawing material issue header table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_BEAMLOT` | VARCHAR2(50) | âœ… | Beam lot number (production identifier) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `HEADERID` | NUMBER | Issue header ID |
| `TOTALRECORD` | NUMBER | Total number of issue line records |
| `MACHINESTART` | DATE | Machine start timestamp |

---

## Business Logic (What it does and why)

Retrieves Drawing material Issue Header data for D365 ERP synchronization. Issue Header represents the summary of all material consumption (weaver's beams consumed) for this drawing production lot. The header must be synced to D365 before individual issue lines (ISL).

The procedure:
1. Takes beam lot number (production identifier)
2. Returns issue header ID for this lot
3. Provides total count of issue line items
4. Includes machine start time for production tracking
5. Header synced first, then lines (ISL) are synced with this header ID

Part of D365 integration pattern: BPO â†’ **ISH** â†’ ISL â†’ OPH/OPL

---

## Related Procedures

**Upstream**:
- [234-D365_DT_BPO.md](./234-D365_DT_BPO.md) - Batch production order (must sync first)

**Downstream**:
- [236-D365_DT_ISL.md](./236-D365_DT_ISL.md) - Issue lines (material detail)

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_DT_ISH(D365_DT_ISHParameter para)`
**Lines**: 33319-33360

---

**File**: 235/296 | **Progress**: 79.4%
