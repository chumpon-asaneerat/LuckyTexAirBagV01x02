# D365_WP_ISL

**Procedure Number**: 222 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Warping Issue Lines data for D365 ERP material consumption detail sync |
| **Operation** | SELECT |
| **Tables** | Warping material issue detail table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_WARPHEADNO` | VARCHAR2(50) | âœ… | Warp header number (lot number) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `LINENO` | NUMBER | Line sequence number |
| `ISSUEDATE` | DATE | Material issue date |
| `ITEMID` | VARCHAR2(50) | Item ID (yarn) in D365 |
| `STYLEID` | VARCHAR2(50) | Style/variant ID |
| `QTY` | NUMBER | Quantity issued (consumed) |
| `UNIT` | VARCHAR2(10) | Unit of measure |
| `SERIALID` | VARCHAR2(50) | Serial/batch ID for traceability |

---

## Business Logic (What it does and why)

Retrieves Warping material Issue Line details for D365 ERP synchronization. Issue Lines are the detail records showing each type of yarn consumed during warping production. Each line represents one yarn material with quantity, batch number, and traceability information.

The procedure:
1. Takes warp header number
2. Returns all material issue line items for this lot
3. Each line has item ID, quantity, batch/serial number
4. Used to post material consumption transactions in D365
5. Enables full material traceability (serial ID tracks yarn lot)

Synced after Issue Header (ISH) is posted to D365.

---

## Related Procedures

**Upstream**:
- [221-D365_WP_ISH.md](./221-D365_WP_ISH.md) - Issue header (must sync first)

**Related**:
- [220-D365_WP_BPO.md](./220-D365_WP_BPO.md) - Batch production order

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\Services\DataService\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\Domains\AirbagSPs.cs`
**Method**: `D365_WP_ISL(D365_WP_ISLParameter para)`
**Lines**: 32611-32656

---

**File**: 222/296 | **Progress**: 75.0%
