# D365_BM_ISH

**Procedure Number**: 228 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Beaming Issue Header for D365 ERP material consumption sync |
| **Operation** | SELECT |
| **Tables** | Beaming material issue header table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_BEAMERNO` | VARCHAR2(50) | âœ… | Beamer number (production lot identifier) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `HEADERID` | NUMBER | Issue header ID |
| `TOTALRECORD` | NUMBER | Total number of issue line records |
| `MACHINESTART` | DATE | Machine start timestamp |

---

## Business Logic (What it does and why)

Retrieves Beaming material Issue Header data for D365 ERP synchronization. Issue Header represents the summary of all material consumption (warp beams consumed) for this beaming production lot. The header must be synced to D365 before individual issue lines (ISL).

The procedure:
1. Takes beamer number (production lot ID)
2. Returns issue header ID for this lot
3. Provides total count of issue line items
4. Includes machine start time for production tracking
5. Header synced first, then lines (ISL) are synced with this header ID

Part of D365 integration pattern: BPO â†’ **ISH** â†’ ISL â†’ OPH/OPL

---

## Related Procedures

**Upstream**:
- [227-D365_BM_BPO.md](./227-D365_BM_BPO.md) - Batch production order (must sync first)

**Downstream**:
- [229-D365_BM_ISL.md](./229-D365_BM_ISL.md) - Issue lines (material detail)

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_BM_ISH(D365_BM_ISHParameter para)`
**Lines**: 32941-32982

---

**File**: 228/296 | **Progress**: 77.0%
