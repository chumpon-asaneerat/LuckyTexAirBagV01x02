# D365_IN_ISL

**Procedure Number**: 257 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Inspection Issue Line details for D365 ERP material consumption detail sync |
| **Operation** | SELECT |
| **Tables** | Inspection material issue detail table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_FINISHINGLOT` | VARCHAR2(50) | âœ… | Finishing lot number (source fabric identifier) |
| `P_INSPECTIONLOT` | VARCHAR2(50) | âœ… | Inspection lot number (production identifier) |
| `P_STARTDATE` | DATE | âœ… | Inspection start date |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `LINENO` | NUMBER | Issue line sequence number |
| `ISSUEDATE` | DATE | Material issue date/time |
| `ITEMID` | VARCHAR2(50) | Item ID (finished fabric) in D365 |
| `STYLEID` | VARCHAR2(50) | Style/variant ID |
| `QTY` | NUMBER | Quantity issued (consumed for inspection) |
| `UNIT` | VARCHAR2(50) | Unit of measure |
| `SERIALID` | VARCHAR2(50) | Serial/batch ID for traceability |

---

## Business Logic (What it does and why)

Retrieves Inspection material Issue Line details for D365 ERP synchronization. Issue Lines are the detail records showing each finished fabric roll consumed/input for inspection. Each line represents one fabric roll input with complete traceability through serial ID.

The procedure:
1. Takes finishing lot, inspection lot, and start date to identify the inspection
2. Returns all issue line items for this inspection
3. Each line shows which finished fabric was inspected (ITEMID, SERIALID)
4. Includes quantity, unit, and issue date/time
5. Used to post material consumption transactions in D365
6. Enables backward traceability (which finished fabric went into inspection)

Synced after Issue Header (ISH) is posted to D365.

---

## Related Procedures

**Upstream**:
- [256-D365_IN_ISH.md](./256-D365_IN_ISH.md) - Issue header (must sync first)

**Related**:
- [255-D365_IN_BPO.md](./255-D365_IN_BPO.md) - Batch production order

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_IN_ISL(D365_IN_ISLParameter para)`
**Lines**: 34501-34546

---

**File**: 257/296 | **Progress**: 86.8%
