# D365_IN_OPL

**Procedure Number**: 259 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Inspection Output Line details for D365 ERP production output detail sync |
| **Operation** | SELECT |
| **Tables** | Inspection production output detail table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_INSPECTIONLOT` | VARCHAR2(50) | âœ… | Inspection lot number (production identifier) |
| `P_STARTDATE` | DATE | âœ… | Inspection start date |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `LINENO` | NUMBER | Output line sequence number |
| `PROCQTY` | NUMBER | Process quantity (inspected fabric length) |
| `OPRNO` | VARCHAR2(50) | Operation number in D365 |
| `OPRID` | VARCHAR2(50) | Operator ID (inspector) who performed inspection |
| `MACHINENO` | VARCHAR2(50) | Machine/station number used for inspection |
| `STARTDATETIME` | DATE | Inspection start date/time |
| `ENDDATETIME` | DATE | Inspection end date/time |

---

## Business Logic (What it does and why)

Retrieves Inspection production Output Line details for D365 ERP synchronization. Output Lines are the detail records showing each inspected fabric roll, including inspector, inspection station, time tracking, and quantity information. Each line represents one fabric roll after inspection with complete traceability.

The procedure:
1. Takes inspection lot and start date to identify the inspection
2. Returns all output line items for this inspection
3. Each line has quantity (fabric length), inspector, station, timestamps
4. Used to post production output transactions in D365
5. Enables production performance tracking (time, quantity per roll, efficiency by inspector/station)

Synced after Output Header (OPH) is posted to D365.

---

## Related Procedures

**Upstream**:
- [258-D365_IN_OPH.md](./258-D365_IN_OPH.md) - Output header (must sync first)

**Related**:
- [255-D365_IN_BPO.md](./255-D365_IN_BPO.md) - Batch production order

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_IN_OPL(D365_IN_OPLParameter para)`
**Lines**: 34601-34646

---

**File**: 259/296 | **Progress**: 87.5%
