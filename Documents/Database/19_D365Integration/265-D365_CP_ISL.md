# D365_CP_ISL

**Procedure Number**: 265 | **Module**: M19 - D365 Integration | **Status**: âœ… ANALYZED

---

## Quick Reference

| Attribute | Value |
|-----------|-------|
| **Purpose** | Get Cutting/Printing Issue Line details for D365 ERP material consumption detail sync |
| **Operation** | SELECT |
| **Tables** | Cutting/Printing material issue detail table |
| **Called From** | D365DataService.cs |
| **Frequency** | High (ERP sync) |
| **Performance** | Fast |
| **Issues** | ðŸŸ¢ None identified |

---

## Parameters

### Input (IN)

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `P_ITEMLOT` | VARCHAR2(50) | âœ… | Item lot number (production identifier) |

### Returns (Cursor)

| Column | Type | Description |
|--------|------|-------------|
| `LINENO` | NUMBER | Issue line sequence number |
| `ISSUEDATE` | DATE | Material issue date/time |
| `ITEMID` | VARCHAR2(50) | Item ID (inspected fabric) in D365 |
| `STYLEID` | VARCHAR2(50) | Style/variant ID |
| `QTY` | NUMBER | Quantity issued (consumed for cutting/printing) |
| `UNIT` | VARCHAR2(50) | Unit of measure |
| `SERIALID` | VARCHAR2(50) | Serial/batch ID for traceability |

---

## Business Logic (What it does and why)

Retrieves Cutting/Printing material Issue Line details for D365 ERP synchronization. Issue Lines are the detail records showing each inspected fabric roll consumed for cutting/printing operations. Each line represents one fabric roll input with complete traceability through serial ID.

The procedure:
1. Takes item lot number to identify the production
2. Returns all issue line items for this lot
3. Each line shows which inspected fabric was used (ITEMID, SERIALID)
4. Includes quantity, unit, and issue date/time
5. Used to post material consumption transactions in D365
6. Enables backward traceability (which inspected fabric went into cutting/printing)

Synced after Issue Header (ISH) is posted to D365.

---

## Related Procedures

**Upstream**:
- [264-D365_CP_ISH.md](./264-D365_CP_ISH.md) - Issue header (must sync first)

**Related**:
- [263-D365_CP_BPO.md](./263-D365_CP_BPO.md) - Batch production order

---

## Query/Code Location

**DataService File**: `LuckyTex.AirBag.Core\\Services\\DataService\\D365DataService.cs`

**Database Manager File**: `LuckyTex.AirBag.Core\\Domains\\AirbagSPs.cs`
**Method**: `D365_CP_ISL(D365_CP_ISLParameter para)`
**Lines**: 34955-35000

---

**File**: 265/296 | **Progress**: 89.5%
